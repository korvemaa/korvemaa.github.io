---
import Layout from "../layouts/Layout.astro";
import ScrollView from "../components/ScrollView.astro";
import ExperienceBar from "../components/ExperienceBar.astro";
import { getCollection } from "astro:content";
import { THEME_HUE_KEY } from "../consts";
import figlet from "figlet";

const now = new Date().getTime();
const experience = (await getCollection("experience")).sort((a, b) => {
	const da = a.data.endDate?.getTime() ?? now;
	const db = b.data.endDate?.getTime() ?? now;
	return db - da;
});

const font = "Future";
const firstName = figlet.textSync("Jake", { font });
const lastName = figlet.textSync("Korvemaa", { font });

const socials = [
	{ title: "GitHub", icon: "github", url: "https://github.com/korvemaa" },
	{
		title: "LinkedIn",
		icon: "linkedin",
		url: "https://linkedin.com/in/jakekve",
	},
	{
		title: "YouTube",
		icon: "youtube",
		url: "https://www.youtube.com/@JakeK",
	},
];

const themes = [
	{ name: "Green", hue: 150 },
	{ name: "Amber", hue: 40 },
	{ name: "Cyan", hue: 180 },
	{ name: "Pink", hue: 300 },
];
---

<Layout>
	<script slot="head" type="application/ld+json">
		{
			"@context": "https://schema.org",
			"@type": "Person",
			"name": "Jake Korvemaa",
			"url": "https://korvema.dev",
			"image": "https://korvemaa.dev/profile.png",
			"jobTitle": "Software Engineer",
			"worksFor": {
				"@type": "Organization",
				"name": "Enviz"
			},
			"nationality": "Australian",
			"birthDate": "2003",
			"sameAs": [
				"https://www.facebook.com/jakekve",
				"https://www.linkedin.com/jakekve",
				"https://github.com/korvema"
			]
		}
	</script>

	<ScrollView useMargin={true} style="scroll-behavior:smooth;">
		<div class="page">
			<section id="hero" style="justify-content: center;">
				<div class="hero-title">
					<pre class="ascii">{firstName}</pre>
					<pre class="ascii">{lastName}</pre>
				</div>
				Software Engineer | Experimentalist
				<hr />
				<div class="socials">
					{
						socials.map((social) => (
							<a
								target="_blank"
								href={social.url}
								class={"icon bi bi-" + social.icon}
							>
								{social.title}
							</a>
						))
					}
				</div>
				<span id="motd">MOTD</span>
			</section>
			<section id="about">
				<h2>About Me</h2>
				<p>
					I'm an incredibly passionate software engineer with a taste
					for <a href="/projects#Motorsport">motorsport</a>. I love
					nothing more then learning, experimenting, refining and
					putting real care into what I build.
				</p>
				<p>
					I'm currently professionally working in C#/Unity but have a
					burning desire to branch out into other software areas that
					are more interesting.
				</p>
				<p>
					If you would like to get in contact with me. You can connect
					with me on <a
						target="_blank"
						href="https://linkedin.com/in/jakekve">LinkedIn</a
					>. I'm always looking for opportunities to keep growing and
					contribute to work that matters.
				</p>
			</section>
			<section id="experience">
				<h2>Experience</h2>
				{experience.map((job) => <ExperienceBar experience={job} />)}
			</section>
			<section style="justify-content: center;">
				<pre
					class="ascii cat">
       _                        
       \`*-.                    
        )  _`-.                 
       .  : `. .                
       : _   '  \               
       ; *` _.   `*-._          
       `-.-'          `-.       
         ;       `       `.     
         :.       .        \    
         . \  .   :   .-'   .   
         '  `+.;  ;  '      :   
         :  '  |    ;       ;-. 
         ; '   : :`-:     _.`* ;
[bug] .*' /  .*' ; .*`- +'  `*' 
      `*-*   `*-*  `*-*'
				</pre>
			</section>
			<section id="themes">
				<h2>Theme</h2>
				<div class="presets">
					{
						themes.map((e) => (
							<button onclick={"window.setHue(" + e.hue + ")"}>
								{e.name}
							</button>
						))
					}
				</div>
				<div class="presets">
					<span id="hue-value">HUE</span>
					<input
						id="hue-slider"
						class="slider"
						type="range"
						min="0"
						max="360"
					/>
				</div>
			</section>
			<section>
				<h2>Skills</h2>
				<p>
					I can work in a wide variety of technologies and areas of
					development. From level design, to texture art to then
					software engineering and anything in between.
				</p>
				<p>
					If you would like a complete set and proof of my skills go
					to my <a href="/projects">projects</a> page. Where I demonstrate
					what I'm capable of in real projects.
				</p>
			</section>
		</div>
	</ScrollView>
</Layout>

<script defer define:vars={{ THEME_HUE_KEY }}>
	const label = document.getElementById("hue-value");
	const slider = document.getElementById("hue-slider");
	const rootStyles = getComputedStyle(document.documentElement);
	const hueValue =
		localStorage.getItem(THEME_HUE_KEY) ||
		rootStyles.getPropertyValue("--base-hue") ||
		"150";

	slider.value = hueValue;
	slider.addEventListener("input", () => {
		setHue(slider.value);
	});

	label.textContent = hueValue;

	function setHue(value) {
		slider.value = value;
		document.documentElement.style.setProperty("--base-hue", value);
		localStorage.setItem(THEME_HUE_KEY, value);
		label.textContent = value;
	}

	window.setHue = setHue;
</script>

<script defer>
	const motd = document.getElementById("motd");
	const proverbs = [
		"When you force a melon from the vines, it won't be sweet.",
		"A man who plants melons will harvest melons, and a man who plants beans will harvest beans.",
		"When you drink the water, remember the spring as the source of the water.",
		"Constant dripping wears away a stone.",
		"It takes more than one cold day for the river to freeze three feet deep.",
		"Just as distance tests a horse's strength, time can reveal a person's heart.",
		"Good medicine tastes bitter.",
		"The timber's already a boat; the rice is cooked.",
		"Great wisdom can seem foolish.",
		"Water drops pierce stone; rope saws cut wood.",
		"Blessings come in disguise.",
		"If you don't do stupid things you won't end up in tragedy.",
		"If small holes aren't fixed, then big holes will bring hardship.",
		"It's better to walk thousands of miles than to read thousands of books.",
		"Too many cooks spoil the broth.",
		"Every step makes a footprint.",
		"Ignorance is bliss.",
		"Disaster comes from the careless talk.",
		"You reap what you sow.",
		"Those who just want speed don't succeed.",
		"A book is a pocket garden.",
		"An inch of time is worth an inch of gold, but an inch of gold may not buy an inch of time.",
		"Flowers may bloom again; you're never young again.",
		"A blind horse always frightens itself.",
		"Different locks must be opened with different keys.",
		"Dig the well before you are thirsty.",
		"The best time to plant a tree was 20 years ago. The second best time is now.",
		"The journey of a thousand miles begins with one step.",
		"An ant's hole can cause the collapse of a dam.",
		"Three parts fate, seven parts hard work.",
		"Give a man a fish, and you feed him for a day; teach a man to fish, and you feed him for a lifetime.",
		"When drinking water, think of its source.",
		"Do not impose on others what you yourself do not desire.",
		"Those who know do not speak, those who speak do not know.",
	];

	function getRandom(min, max) {
		return Math.floor(Math.random() * (max - min + 1)) + min;
	}

	motd.textContent = proverbs[getRandom(0, proverbs.length - 1)];
</script>

<style>
	.page {
		display: grid;
		grid-template-columns: repeat(auto-fill, minmax(min(450px, 100%), 1fr));
		margin: 1rem;
		gap: 1rem;
	}

	.slider {
		-webkit-appearance: none;
		appearance: none;
		display: flex;
		margin: 0;
		flex-grow: 1;
		cursor: pointer;
		background-color: transparent;
		outline: none;
		overflow: hidden;

		border: var(--border-width) dotted var(--dimmed-glow-color);
	}

	.slider::-webkit-slider-runnable-track {
		height: 16px;
		background: transparent;
		border-radius: 16px;
	}

	.slider::-moz-range-track {
		height: 16px;
		background: #ccc;
		border-radius: 16px;
	}

	.slider::-webkit-slider-thumb {
		-webkit-appearance: none;
		appearance: none;
		height: 16px;
		width: 8px;
		background-color: var(--text-color);
		box-shadow: -900px 0 0 900px var(--dimmed-glow-color);
	}

	.slider::-moz-range-thumb {
		height: 16px;
		width: 8px;
		background-color: #fff;
		box-shadow: -900px 0 0 900px #f50;
	}

	section {
		display: flex;
		flex-direction: column;
		padding: 1rem;
		border: var(--border-width) dotted var(--dimmed-glow-color);
		overflow: hidden;
		gap: 1rem;
	}

	section p,
	section h2 {
		/* Spacing is driven by gap */
		margin: 0;
	}

	.socials {
		display: flex;
		flex-direction: row;
		flex-wrap: wrap;
		gap: 1rem;
	}

	.socials a {
		padding: 0.5rem 1rem;
		border: var(--border-width) dotted var(--dimmed-glow-color);
		display: flex;
		flex-grow: 1;
		justify-content: center;
		text-decoration: none;
		align-items: center;
	}

	.socials a:hover {
		background-color: var(--dimmed-glow-color);
	}

	.socials a::before {
		padding-right: 1rem;
	}

	.ascii {
		font-family: monospace;
		font-synthesis-weight: none;
		font-variant-ligatures: none;
		line-height: 1;
		padding: 0;
		margin: 0;
		user-select: none;
	}

	.cat {
		flex-grow: 1;
		align-items: center;
		justify-content: center;
		display: flex;
		flex-direction: column;
	}

	#themes .presets {
		display: flex;
		flex-direction: row;
		flex-wrap: wrap;
		gap: 1rem;
		align-items: center;
	}
	
	#themes .presets button {
		align-items: center;
		justify-content: center;
		display: flex;
		flex-grow: 1;

		appearance: none;
		background-color: unset;
		border: var(--border-width) dotted var(--dimmed-glow-color);
		padding: 0.75rem 1rem;

		font-family: Terminus;

		color: var(--text-color);
		text-shadow: var(--text-shadow);
	}

	#themes .presets button:hover {
		background-color: var(--dimmed-glow-color);
	}
</style>
