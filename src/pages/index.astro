---
import Layout from "../layouts/Layout.astro";
import ScrollView from "../components/ScrollView.astro";
import ExperienceBar from "../components/ExperienceBar.astro";
import { getCollection } from "astro:content";
import figlet from "figlet";

const now = new Date().getTime();
const experience = (await getCollection("experience")).sort((a, b) => {
	const da = a.data.endDate?.getTime() ?? now;
	const db = b.data.endDate?.getTime() ?? now;
	return db - da;
});

const font = "Future";
const firstName = figlet.textSync("Jake", { font });
const lastName = figlet.textSync("Korvemaa", { font });

const socials = [
	{ title: "GitHub", icon: "github", url: "https://github.com/korvemaa" },
	{
		title: "LinkedIn",
		icon: "linkedin",
		url: "https://linkedin.com/in/jakekve",
	},
	{
		title: "YouTube",
		icon: "youtube",
		url: "https://www.youtube.com/@JakeK",
	},
];
---

<Layout>
	<script slot="head" type="application/ld+json">
		{
			"@context": "https://schema.org",
			"@type": "Person",
			"name": "Jake Korvemaa",
			"url": "https://korvema.dev",
			"image": "https://korvemaa.dev/profile.png",
			"jobTitle": "Software Engineer",
			"worksFor": {
				"@type": "Organization",
				"name": "Enviz"
			},
			"nationality": "Australian",
			"birthDate": "2003",
			"sameAs": [
				"https://www.facebook.com/jakekve",
				"https://www.linkedin.com/jakekve",
				"https://github.com/korvema"
			]
		}
	</script>

	<ScrollView useMargin={true} style="scroll-behavior:smooth;">
		<div class="page">
			<section style="justify-content: center;">
				<div>
					<pre class="ascii">{firstName}</pre>
					<pre class="ascii">{lastName}</pre>
				</div>
				Software Engineer | Experimentalist
				<hr />
				<div class="socials">
					{
						socials.map((social) => (
							<a
								target="_blank"
								href={social.url}
								class={"icon bi bi-" + social.icon}
							>
								{social.title}
							</a>
						))
					}
				</div>
			</section>
			<section id="status">
				<h2>[00] Status</h2>
				<hr />
				<!-- Spotify status through discord -->
				<div class="spotify-status">
					Playing on Spotify
					<div class="spotify-details">
						<div class="song-disk">
							<img id="song-art" alt="Album art" />
						</div>
						<div class="song-content">
							<span id="song-name"></span>
							<span id="song-artist"></span>
						</div>
					</div>
				</div>
				<div style="display:flex;flex-grow:1;"></div>
				<hr />
				<span id="motd" style="align-self: flex-start;">MOTD</span>
			</section>
			<section id="about">
				<h2>[01] About Me</h2>
				<hr />
				<p>
					I'm an incredibly passionate software engineer with a taste
					for <a href="/projects#Motorsport">motorsport</a>. I love
					nothing more then learning, experimenting, refining and
					putting real care into what I build.
				</p>
				<p>
					I'm currently professionally working in C#/Unity but have a
					burning desire to branch out into other software areas that
					are more interesting.
				</p>
				<p>
					If you would like to get in contact with me. You can connect
					with me on <a
						target="_blank"
						href="https://linkedin.com/in/jakekve">LinkedIn</a
					>. I'm always looking for opportunities to keep growing and
					contribute to work that matters.
				</p>
			</section>
			<section>
				<h2>[02] Skills</h2>
				<hr />
				<p>
					I can work in a wide variety of technologies and areas of
					development. From level design, to texture art to then
					software engineering and anything in between.
				</p>
				<p>
					If you would like a complete set and proof of my skills go
					to my <a href="/projects">projects</a> page. Where I demonstrate
					what I'm capable of in real projects.
				</p>
			</section>
			<section id="experience">
				<h2>[03] Professional Experience</h2>
				<hr />
				{experience.map((job) => <ExperienceBar experience={job} />)}
			</section>
			<section style="justify-content: center;">
				<pre
					class="ascii cat">
       _                        
       \`*-.                    
        )  _`-.                 
       .  : `. .                
       : _   '  \               
       ; *` _.   `*-._          
       `-.-'          `-.       
         ;       `       `.     
         :.       .        \    
         . \  .   :   .-'   .   
         '  `+.;  ;  '      :   
         :  '  |    ;       ;-. 
         ; '   : :`-:     _.`* ;
[bug] .*' /  .*' ; .*`- +'  `*' 
      `*-*   `*-*  `*-*'
				</pre>
			</section>
		</div>
	</ScrollView>
</Layout>

<script defer>
	function getStatus() {
		return fetch(
			"https://api.lanyard.rest/v1/users/761439375594094612",
		).then((r) => r.json());
	}

	getStatus().then((status) => {
		if (!status.success) return; // Ignore

		const data = status.data;

		if (data.spotify != null) {
			document
				.querySelector(".spotify-status")
				.classList.add("has-status");

			const s = data.spotify;
			document.getElementById("song-art").src = s.album_art_url;

			document.getElementById("song-name").textContent = s.song;
			document.getElementById("song-artist").textContent = s.artist;
		}
	});
</script>

<script defer>
	const motd = document.getElementById("motd");
	const proverbs = [
		"When you force a melon from the vines, it won't be sweet.",
		"A man who plants melons will harvest melons, and a man who plants beans will harvest beans.",
		"When you drink the water, remember the spring as the source of the water.",
		"Constant dripping wears away a stone.",
		"It takes more than one cold day for the river to freeze three feet deep.",
		"Just as distance tests a horse's strength, time can reveal a person's heart.",
		"Good medicine tastes bitter.",
		"The timber's already a boat; the rice is cooked.",
		"Great wisdom can seem foolish.",
		"Water drops pierce stone; rope saws cut wood.",
		"Blessings come in disguise.",
		"If you don't do stupid things you won't end up in tragedy.",
		"If small holes aren't fixed, then big holes will bring hardship.",
		"It's better to walk thousands of miles than to read thousands of books.",
		"Too many cooks spoil the broth.",
		"Every step makes a footprint.",
		"Ignorance is bliss.",
		"Disaster comes from the careless talk.",
		"You reap what you sow.",
		"Those who just want speed don't succeed.",
		"A book is a pocket garden.",
		"An inch of time is worth an inch of gold, but an inch of gold may not buy an inch of time.",
		"Flowers may bloom again; you're never young again.",
		"A blind horse always frightens itself.",
		"Different locks must be opened with different keys.",
		"Dig the well before you are thirsty.",
		"The best time to plant a tree was 20 years ago. The second best time is now.",
		"The journey of a thousand miles begins with one step.",
		"An ant's hole can cause the collapse of a dam.",
		"Three parts fate, seven parts hard work.",
		"Give a man a fish, and you feed him for a day; teach a man to fish, and you feed him for a lifetime.",
		"When drinking water, think of its source.",
		"Do not impose on others what you yourself do not desire.",
		"Those who know do not speak, those who speak do not know.",
	];

	function randomProverb() {
		return proverbs[Math.floor(Math.random() * proverbs.length)];
	}

	const SPEED = 60; // pixels per second (tweak to taste)

	function runMotd() {
		motd.textContent = randomProverb();
		motd.style.transition = "none";
		motd.style.transform = `translateX(${motd.parentElement.clientWidth}px)`;

		requestAnimationFrame(() => {
			const textWidth = motd.offsetWidth;
			const screenWidth = motd.parentElement.clientWidth;
			const duration = (screenWidth + textWidth) / SPEED;

			motd.style.transition = `transform ${duration}s linear`;
			motd.style.transform = `translateX(-${textWidth}px)`;

			setTimeout(runMotd, duration * 1000);
		});
	}

	runMotd();
</script>

<style>
	.page {
		display: grid;
		grid-template-columns: repeat(auto-fill, minmax(min(450px, 100%), 1fr));
		margin: 1rem;
		gap: 1rem;
	}

	.slider {
		-webkit-appearance: none;
		appearance: none;
		display: flex;
		margin: 0;
		flex-grow: 1;
		cursor: pointer;
		background-color: transparent;
		outline: none;
		overflow: hidden;

		border: var(--border-width) dotted var(--dimmed-glow-color);
	}

	.slider::-webkit-slider-runnable-track {
		height: 16px;
		background: transparent;
		border-radius: 16px;
	}

	.slider::-moz-range-track {
		background: transparent;
	}

	.slider::-webkit-slider-thumb {
		-webkit-appearance: none;
		appearance: none;
		height: 16px;
		width: 8px;
		background-color: var(--text-color);
		box-shadow: -900px 0 0 900px var(--dimmed-glow-color);
	}

	.slider::-moz-range-thumb {
		appearance: none;
		height: 99px;
		width: 8px;
		background-color: var(--text-color);
		border-radius: 0;
		border-width: 0;
		box-shadow: -900px 0 0 900px var(--dimmed-glow-color);
	}

	section {
		display: flex;
		flex-direction: column;
		padding: 1rem;
		border: var(--border-width) dotted var(--dimmed-glow-color);
		overflow: hidden;
		gap: 0.5rem;
	}

	section p,
	section h2 {
		/* Spacing is driven by gap */
		margin: 0;
		background-color: transparent;
		padding: 0;
		font-size: 14px;
	}

	.socials {
		display: flex;
		flex-direction: row;
		flex-wrap: wrap;
		gap: 1rem;
	}

	.socials a {
		padding: 0.5rem 1rem;
		border: var(--border-width) dotted var(--dimmed-glow-color);
		display: flex;
		flex-grow: 1;
		justify-content: center;
		text-decoration: none;
		align-items: center;
	}

	.socials a:hover {
		background-color: var(--dimmed-glow-color)		gap: 1rem;;
	}

	.socials a::before {
		padding-right: 1rem;
	}

	.ascii {
		font-family: monospace;
		font-synthesis-weight: none;
		font-variant-ligatures: none;
		line-height: 1;
		padding: 0;
		margin: 0;
		user-select: none;
	}

	.cat {
		flex-grow: 1;
		align-items: center;
		justify-content: center;
		display: flex;
		flex-direction: column;
	}

	/* Status */

	#motd {
		white-space: nowrap;
	}

	.spotify-details {
		display: flex;
		flex-direction: row;
		align-items: center;
		gap: 1rem;
	}

	.spotify-status {
		display: none;
		gap: 0.5rem;
	}

	.spotify-status.has-status {
		display: flex;
		flex-direction: column;
	}

	.spotify-details .song-content {
		display: flex;
		flex-direction: column;
	}

	.spotify-details .song-disk {
		position: relative;
		aspect-ratio: 1/1;
		width: 50px;
		border-radius: 50%;
		overflow: hidden;
		animation: spin 6s linear infinite;
	}

	/* light reflection */
	.song-disk::before {
		content: "";
		position: absolute;
		inset: 0;
		border-radius: 50%;
		background: linear-gradient(
			135deg,
			rgba(255, 255, 255, 0.15),
			rgba(255, 255, 255, 0)
		);
		z-index: 1;
		pointer-events: none;
	}

	@keyframes spin {
		from {
			transform: rotate(0deg);
		}
		to {
			transform: rotate(360deg);
		}
	}

	.online-status #song-art {
		appearance: none;
		border: 0;

		-webkit-mask: radial-gradient(
			circle,
			transparent 0 10%,
			white 12% 100%
		);
		mask: radial-gradient(circle, transparent 0 7%, white 7% 100%);
	}

	.online-status span {
		display: flex;
		min-width: 0;
		white-space: normal;
		flex-shrink: 1;
	}
</style>
